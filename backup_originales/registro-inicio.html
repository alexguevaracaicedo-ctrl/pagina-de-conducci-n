<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido a Liberty Transport S.A.S.</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/transporte-mejorado.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/registro.css') }}">
</head>

<body>
    <div class="patron-fondo"></div>

    <div class="container-auth">
        <div class="seccion-bienvenida">
            <div class="logo-principal">
                <div class="icono-logo">
                    <a href="./ChatGPT Image 14 oct 2025, 12_53_54.png"></a>
                </div>
                <div class="texto-logo">
                    <h1>Liberty Transport</h1>
                    <span>S.A.S.</span>
                </div>
            </div>

            <div class="contenido-bienvenida">
                <h2>Conectando el Choc√≥ con seguridad y confianza</h2>
                <p>√önete a la plataforma de transporte m√°s confiable del Pac√≠fico colombiano. Accede a rutas seguras,
                    horarios actualizados y servicios adaptados a tus necesidades.</p>

                <div class="beneficios-lista">
                    <div class="beneficio-item">
                        <div class="icono-beneficio">üöå</div>
                        <span>M√∫ltiples opciones de transporte</span>
                    </div>
                    <div class="beneficio-item">
                        <div class="icono-beneficio">üó∫Ô∏è</div>
                        <span>Rutas por todo el Choc√≥</span>
                    </div>
                    <div class="beneficio-item">
                        <div class="icono-beneficio">‚è∞</div>
                        <span>Horarios en tiempo real</span>
                    </div>
                    <div class="beneficio-item">
                        <div class="icono-beneficio">üõ°Ô∏è</div>
                        <span>Viajes seguros y confiables</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="seccion-auth">
            <div class="contenedor-formularios">

                <div class="formulario-contenedor" id="login-form">
                    <div class="encabezado-formulario">
                        <h3>Iniciar Sesi√≥n</h3>
                        <p>Accede a tu cuenta para continuar</p>
                    </div>

                    <form class="formulario-auth" id="form-login">
                        <div class="grupo-input">
                            <label for="login-email">Correo electr√≥nico</label>
                            <input type="email" id="login-email" name="email" placeholder="tu@ejemplo.com" required>
                        </div>

                        <div class="grupo-input">
                            <label for="login-password">Contrase√±a</label>
                            <input type="password" id="login-password" name="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        </div>

                        <div class="opciones-extras">
                            <label class="checkbox-container">
                                <input type="checkbox" name="recordar">
                                <span class="checkmark"></span>
                                Recordarme
                            </label>
                            <a href="#" class="link-recuperar">¬øOlvidaste tu contrase√±a?</a>
                        </div>

                        <div id="login-error" class="mensaje-error" style="display: none;"></div>

                        <button type="submit" class="boton-auth boton-primario" id="btn-login">
                            <span>Iniciar Sesi√≥n</span>
                            <div class="icono-boton">‚Üí</div>
                        </button>
                    </form>

                    <div class="separador-formulario">
                        <span>¬øNo tienes cuenta?</span>
                        <button type="button" class="boton-cambiar" onclick="mostrarSeleccionTipo()">
                            Cr√©ate una aqu√≠
                        </button>
                    </div>
                </div>


                <div class="formulario-contenedor oculto" id="tipo-usuario-form">
                    <div class="encabezado-formulario">
                        <h3>¬øC√≥mo deseas usar √Åguila?</h3>
                        <p>Selecciona el tipo de cuenta que necesitas</p>
                    </div>

                    <div class="selector-tipo-usuario">
                        <div class="tarjeta-tipo-usuario" onclick="seleccionarTipo('pasajero')">
                            <div class="icono-tipo-usuario">üß≥</div>
                            <h4>Soy Pasajero</h4>
                            <p>Quiero viajar y reservar servicios de transporte</p>
                            <div class="caracteristicas-tipo">
                                <span>‚úì Reservar viajes</span>
                                <span>‚úì Ver horarios</span>
                                <span>‚úì Gestionar reservas</span>
                            </div>
                        </div>

                        <div class="tarjeta-tipo-usuario" onclick="seleccionarTipo('conductor')">
                            <div class="icono-tipo-usuario">üöó</div>
                            <h4>Soy Conductor</h4>
                            <p>Quiero ofrecer mis servicios de transporte</p>
                            <div class="caracteristicas-tipo">
                                <span>‚úì Recibir solicitudes</span>
                                <span>‚úì Gestionar servicios</span>
                                <span>‚úì Generar ingresos</span>
                            </div>
                        </div>
                    </div>

                    <div class="separador-formulario">
                        <button type="button" class="boton-cambiar" onclick="mostrarLogin()">
                            ‚Üê Volver al inicio
                        </button>
                    </div>
                </div>


                <div class="formulario-contenedor oculto" id="register-pasajero-form">
                    <div class="encabezado-formulario">
                        <h3>Crear Cuenta - Pasajero</h3>
                        <p>Reg√≠strate para acceder a todos nuestros servicios</p>
                    </div>

                    <form class="formulario-auth" id="form-registro-pasajero">
                        <input type="hidden" name="tipo_usuario" value="pasajero">

                        <div class="grupo-input-doble">
                            <div class="grupo-input">
                                <label for="pasajero-nombre">Nombre</label>
                                <input type="text" id="pasajero-nombre" name="nombre" placeholder="Tu nombre" required>
                            </div>
                            <div class="grupo-input">
                                <label for="pasajero-apellido">Apellido</label>
                                <input type="text" id="pasajero-apellido" name="apellido" placeholder="Tu apellido"
                                    required>
                            </div>
                        </div>

                        <div class="grupo-input">
                            <label for="pasajero-email">Correo electr√≥nico</label>
                            <input type="email" id="pasajero-email" name="email" placeholder="tu@ejemplo.com" required>
                        </div>

                        <div class="grupo-input">
                            <label for="pasajero-telefono">Tel√©fono</label>
                            <input type="tel" id="pasajero-telefono" name="telefono" placeholder="+57 300 123 4567"
                                required>
                        </div>

                        <div class="grupo-input">
                            <label for="pasajero-cedula">N√∫mero de identificaci√≥n</label>
                            <input type="text" id="pasajero-cedula" name="cedula" placeholder="12345678" required>
                        </div>

                        <div class="grupo-input">
                            <label for="pasajero-password">Contrase√±a</label>
                            <input type="password" id="pasajero-password" name="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                required>
                            <small class="ayuda-password">M√≠nimo 8 caracteres, incluir letras y n√∫meros</small>
                        </div>

                        <div class="grupo-input">
                            <label for="pasajero-confirm-password">Confirmar contrase√±a</label>
                            <input type="password" id="pasajero-confirm-password" name="confirm_password"
                                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        </div>

                        <div class="opciones-extras">
                            <label class="checkbox-container">
                                <input type="checkbox" name="terminos" required>
                                <span class="checkmark"></span>
                                Acepto los t√©rminos y condiciones
                            </label>
                        </div>

                        <div id="register-pasajero-error" class="mensaje-error" style="display: none;"></div>

                        <button type="submit" class="boton-auth boton-primario" id="btn-registro-pasajero">
                            <span>Crear Cuenta</span>
                            <div class="icono-boton">‚úì</div>
                        </button>
                    </form>

                    <div class="separador-formulario">
                        <button type="button" class="boton-cambiar" onclick="mostrarSeleccionTipo()">
                            ‚Üê Volver
                        </button>
                    </div>
                </div>


                <div class="formulario-contenedor oculto" id="register-conductor-form">
                    <div class="encabezado-formulario">
                        <h3>Crear Cuenta - Conductor</h3>
                        <p>Completa tu informaci√≥n para trabajar con nosotros</p>
                    </div>

                    <form class="formulario-auth" id="form-registro-conductor">
                        <input type="hidden" name="tipo_usuario" value="conductor">

                        <div class="seccion-formulario">
                            <h4 class="titulo-seccion-form">Datos Personales</h4>

                            <div class="grupo-input-doble">
                                <div class="grupo-input">
                                    <label for="conductor-nombre">Nombre *</label>
                                    <input type="text" id="conductor-nombre" name="nombre" required>
                                </div>
                                <div class="grupo-input">
                                    <label for="conductor-apellido">Apellido *</label>
                                    <input type="text" id="conductor-apellido" name="apellido" required>
                                </div>
                            </div>

                            <div class="grupo-input">
                                <label for="conductor-email">Correo electr√≥nico *</label>
                                <input type="email" id="conductor-email" name="email" required>
                            </div>

                            <div class="grupo-input-doble">
                                <div class="grupo-input">
                                    <label for="conductor-telefono">Tel√©fono *</label>
                                    <input type="tel" id="conductor-telefono" name="telefono" required>
                                </div>
                                <div class="grupo-input">
                                    <label for="conductor-cedula">C√©dula *</label>
                                    <input type="text" id="conductor-cedula" name="cedula" required>
                                </div>
                            </div>
                        </div>

                        <div class="seccion-formulario">
                            <h4 class="titulo-seccion-form">Informaci√≥n de Licencia</h4>

                            <div class="grupo-input">
                                <label for="conductor-licencia">N√∫mero de Licencia *</label>
                                <input type="text" id="conductor-licencia" name="numero_licencia" required>
                            </div>

                            <div class="grupo-input-doble">
                                <div class="grupo-input">
                                    <label for="conductor-categoria">Categor√≠a *</label>
                                    <select id="conductor-categoria" name="categoria_licencia" required>
                                        <option value="">Seleccionar</option>
                                        <option value="A1">A1 - Motocicletas hasta 125cc</option>
                                        <option value="A2">A2 - Motocicletas mayores 125cc</option>
                                        <option value="B1">B1 - Autom√≥viles</option>
                                        <option value="B2">B2 - Camionetas y camperos</option>
                                        <option value="C1">C1 - Camiones r√≠gidos</option>
                                        <option value="C2">C2 - Veh√≠culos articulados</option>
                                    </select>
                                </div>
                                <div class="grupo-input">
                                    <label for="conductor-vencimiento">Vencimiento *</label>
                                    <input type="date" id="conductor-vencimiento" name="fecha_vencimiento_licencia"
                                        required>
                                </div>
                            </div>

                            <div class="grupo-input">
                                <label for="conductor-experiencia">A√±os de Experiencia *</label>
                                <input type="number" id="conductor-experiencia" name="a√±os_experiencia" min="0" max="50"
                                    required>
                            </div>

                            <div class="grupo-input">
                                <label class="checkbox-container">
                                    <input type="checkbox" name="vehiculo_propio" id="conductor-vehiculo-propio">
                                    <span class="checkmark"></span>
                                    Tengo veh√≠culo propio
                                </label>
                            </div>
                        </div>

                        <div class="seccion-formulario">
                            <h4 class="titulo-seccion-form">Seguridad</h4>

                            <div class="grupo-input">
                                <label for="conductor-password">Contrase√±a *</label>
                                <input type="password" id="conductor-password" name="password" required>
                                <small class="ayuda-password">M√≠nimo 8 caracteres, incluir letras y n√∫meros</small>
                            </div>

                            <div class="grupo-input">
                                <label for="conductor-confirm-password">Confirmar contrase√±a *</label>
                                <input type="password" id="conductor-confirm-password" name="confirm_password" required>
                            </div>
                        </div>

                        <div class="opciones-extras">
                            <label class="checkbox-container">
                                <input type="checkbox" name="terminos" required>
                                <span class="checkmark"></span>
                                Acepto los t√©rminos y condiciones
                            </label>
                        </div>

                        <div class="alerta-info">
                            <span class="icono-alerta">‚ÑπÔ∏è</span>
                            <p>Tu solicitud ser√° revisada por nuestro equipo. Te notificaremos por email cuando sea
                                aprobada.</p>
                        </div>

                        <div id="register-conductor-error" class="mensaje-error" style="display: none;"></div>

                        <button type="submit" class="boton-auth boton-primario" id="btn-registro-conductor">
                            <span>Enviar Solicitud</span>
                            <div class="icono-boton">‚úì</div>
                        </button>
                    </form>

                    <div class="separador-formulario">
                        <button type="button" class="boton-cambiar" onclick="mostrarSeleccionTipo()">
                            ‚Üê Volver
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="modal-exito" class="modal oculto">
        <div class="modal-contenido">
            <div class="modal-icono">‚úì</div>
            <h3 id="modal-titulo">¬°Bienvenido a Transporte √Åguila!</h3>
            <p id="modal-mensaje">Tu cuenta ha sido creada exitosamente.</p>
            <button class="boton-auth boton-primario" onclick="mostrarLogin()">
                Iniciar Sesi√≥n
            </button>
        </div>
    </div>

    <script>
        const loginForm = document.getElementById('login-form');
        const tipoUsuarioForm = document.getElementById('tipo-usuario-form');
        const registerPasajeroForm = document.getElementById('register-pasajero-form');
        const registerConductorForm = document.getElementById('register-conductor-form');
        const modalExito = document.getElementById('modal-exito');

        let tipoUsuarioSeleccionado = 'pasajero';

        function mostrarError(elementId, mensaje) {
            const errorDiv = document.getElementById(elementId);
            errorDiv.textContent = mensaje;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function ocultarTodos() {
            [loginForm, tipoUsuarioForm, registerPasajeroForm, registerConductorForm].forEach(form => {
                form.classList.add('oculto');
                form.classList.remove('visible');
            });
        }

        function mostrarFormulario(formulario) {
            ocultarTodos();
            formulario.classList.remove('oculto');
            setTimeout(() => {
                formulario.classList.add('visible');
            }, 50);
        }

        function mostrarLogin() {
            mostrarFormulario(loginForm);
            modalExito.classList.add('oculto');
        }

        function mostrarSeleccionTipo() {
            mostrarFormulario(tipoUsuarioForm);
        }

        function seleccionarTipo(tipo) {
            tipoUsuarioSeleccionado = tipo;
            if (tipo === 'pasajero') {
                mostrarFormulario(registerPasajeroForm);
            } else {
                mostrarFormulario(registerConductorForm);
            }
        }


        document.getElementById('form-login').addEventListener('submit', async function (e) {
            e.preventDefault();

            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const boton = document.getElementById('btn-login');

            if (!email || !password) {
                mostrarError('login-error', 'Por favor, completa todos los campos');
                return;
            }

            const textoOriginal = boton.innerHTML;
            boton.innerHTML = '<span>Iniciando...</span><div class="loader"></div>';
            boton.disabled = true;

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });

                const data = await response.json();

                if (data.success) {
                    window.location.href = '/dashboard';
                } else {
                    mostrarError('login-error', data.message);
                }
            } catch (error) {
                mostrarError('login-error', 'Error de conexi√≥n. Intenta nuevamente.');
            } finally {
                boton.innerHTML = textoOriginal;
                boton.disabled = false;
            }
        });


        document.getElementById('form-registro-pasajero').addEventListener('submit', async function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            const boton = document.getElementById('btn-registro-pasajero');

            if (data.password !== data.confirm_password) {
                mostrarError('register-pasajero-error', 'Las contrase√±as no coinciden');
                return;
            }

            if (!data.terminos) {
                mostrarError('register-pasajero-error', 'Debes aceptar los t√©rminos y condiciones');
                return;
            }

            const textoOriginal = boton.innerHTML;
            boton.innerHTML = '<span>Creando cuenta...</span><div class="loader"></div>';
            boton.disabled = true;

            try {
                const response = await fetch('/api/registro', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('modal-titulo').textContent = '¬°Bienvenido a Transporte √Åguila!';
                    document.getElementById('modal-mensaje').textContent = 'Tu cuenta ha sido creada exitosamente. Ahora puedes iniciar sesi√≥n.';
                    modalExito.classList.remove('oculto');
                    modalExito.classList.add('visible');
                    this.reset();
                } else {
                    mostrarError('register-pasajero-error', result.message);
                }
            } catch (error) {
                mostrarError('register-pasajero-error', 'Error de conexi√≥n. Intenta nuevamente.');
            } finally {
                boton.innerHTML = textoOriginal;
                boton.disabled = false;
            }
        });


        document.getElementById('form-registro-conductor').addEventListener('submit', async function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            data.vehiculo_propio = document.getElementById('conductor-vehiculo-propio').checked;
            const boton = document.getElementById('btn-registro-conductor');

            if (data.password !== data.confirm_password) {
                mostrarError('register-conductor-error', 'Las contrase√±as no coinciden');
                return;
            }

            if (!data.terminos) {
                mostrarError('register-conductor-error', 'Debes aceptar los t√©rminos y condiciones');
                return;
            }


            const fechaVencimiento = new Date(data.fecha_vencimiento_licencia);
            const hoy = new Date();
            if (fechaVencimiento < hoy) {
                mostrarError('register-conductor-error', 'La licencia est√° vencida');
                return;
            }

            const textoOriginal = boton.innerHTML;
            boton.innerHTML = '<span>Enviando solicitud...</span><div class="loader"></div>';
            boton.disabled = true;

            try {
                const response = await fetch('/api/registro', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('modal-titulo').textContent = '¬°Solicitud Enviada!';
                    document.getElementById('modal-mensaje').textContent = 'Tu solicitud como conductor est√° siendo revisada. Te notificaremos por email cuando sea aprobada.';
                    modalExito.classList.remove('oculto');
                    modalExito.classList.add('visible');
                    this.reset();
                } else {
                    mostrarError('register-conductor-error', result.message);
                }
            } catch (error) {
                mostrarError('register-conductor-error', 'Error de conexi√≥n. Intenta nuevamente.');
            } finally {
                boton.innerHTML = textoOriginal;
                boton.disabled = false;
            }
        });


        const fechaVencimientoInput = document.getElementById('conductor-vencimiento');
        if (fechaVencimientoInput) {
            const hoy = new Date().toISOString().split('T')[0];
            fechaVencimientoInput.min = hoy;
        }


        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(() => {
                loginForm.classList.add('visible');
            }, 100);
        });
    </script>
</body>

</html>